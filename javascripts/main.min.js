"use strict";var SVGSpriteConfigurator=function(a,b,c,d,e){this.config=a,this.$form=b,this.$compiled=c,this.values={},this.reserved=["label","default","skip","type","options","emphasize"],this.register={},this.debug=!!e,this.tab=null,this.compiled={},this.prepareTabs(d),this.build(this.$form,this.config,[]),this.update()};SVGSpriteConfigurator.prototype.prepareTabs=function(a){var b=this;a.each(function(a,c){var d=$("pre",c);c.template=d.length?d.text():"$$config$$",c.onclick=function(){b.tab=this,b.update()}}),this.tab=a[0]},SVGSpriteConfigurator.prototype.build=function(a,b,c){for(var d in b)switch(b[d].type){case"string":this.buildString(a,d,b[d],c);break;case"integer":this.buildInteger(a,d,b[d],c);break;case"boolean":this.buildBoolean(a,d,b[d],c);break;case"select":this.buildSelect(a,d,b[d],c);break;case"section":this.buildSection(a,d,b[d],c);break;case"enableconfig":this.buildEnableConfig(a,d,b[d],c);break;case"manual":this.buildManual(a,d,b[d],c);break;case"list":}return a},SVGSpriteConfigurator.prototype.buildString=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=$('<input type="text" name="'+e+'" data-skip="'+c.skip+'"/>');f.attr("value",this.values[e]),f.attr("placeholder",c["default"]),a.append($("<label/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend(f)),this.register[e]=$.extend({_:f[0]},c),f.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildInteger=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=$('<input type="number" name="'+e+'" data-skip="'+c.skip+'" min="0" step="1" pattern="d*"/>');f.attr("value",this.values[e]),f.attr("placeholder",c["default"]),a.append($("<label"+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend(f)),this.register[e]=$.extend({_:f[0]},c),f.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildBoolean=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=$('<input type="checkbox" name="'+e+'" value="1" data-skip="'+c.skip+'"'+(c["default"]?' checked="checked"':"")+"/>"),g=$('<span class="boolean"><input type="hidden" name="'+e+'" value="0"/></span>').append(f);a.append($("<label"+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend(g)),this.register[e]=$.extend({_:f[0]},c),f.click($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildSelect=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=$('<select name="'+e+'" data-skip="'+c.skip+'"/>'),g=this.values[e]||c["default"];for(var h in c.options)f.append($('<option value="'+h+'"'+(h==g?' selected="selected"':"")+"/>").text(c.options[h]));a.append($("<label"+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend(f)),this.register[e]=$.extend({_:f[0]},c),f.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildSection=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=!1,g={},h=0,i=this;if($.each(this.values,function(a){0===a.indexOf(section+"_")&&(f=!0)}),$.each(c,function(a,b){i.reserved.indexOf(a)<0&&(g[a]=b,++h)}),h){var j=d.slice(0);j.push(b);var k=$('<label for="'+e+'"'+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend('<span class="toggle" data-exand="►" data-collapse="▼"></span>'),l=$("<legend/>").append(k),m=$("<fieldset/>").append($('<input type="checkbox" id="'+e+'" class="section"'+(f?' checked="checked"':"")+' data-skip="'+c.skip+'"/>')).append(l).append(this.build($('<div class="subsection"/>'),g,j));a.append(m),this.register[e]=c}},SVGSpriteConfigurator.prototype.buildEnableConfig=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=parseInt(this.values[e]||c["default"],10),g=!1,h={},i=0;$.each(this.values,function(a){0===a.indexOf(enable+"_")&&(g=!0)});var j=this;if($.each(c,function(a,b){j.reserved.indexOf(a)<0&&(h[a]=b,++i)}),i){var k=d.slice(0);k.push(b);var l=$('<input type="radio" id="'+e+'.skip" name="'+e+'" class="skip" value="0"'+(0==f?' checked="checked"':"")+">"),m=$('<label class="enable" for="'+e+'.skip">Skip</label>'),n=$('<input type="radio" id="'+e+'.enable" name="'+e+'" class="enable" value="1"'+(1==f?' checked="checked"':"")+">"),o=$('<label class="enable" for="'+e+'.enable">Enable</label>'),p=$('<input type="radio" id="'+e+'.configure" name="'+e+'" class="configure" value="2"'+(2==f?' checked="checked"':"")+">"),q=$('<label class="enable" for="'+e+'.configure">Configure</label>'),r=$("<fieldset/>").append($('<legend class="label"/>').append($('<label for="'+e+'.enable"'+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))))).append(n,o,p,q,l,m).append(this.build($('<div class="subsection"/>'),h,k));a.append(r),this.register[e]=$.extend({_0:l[0],_1:n[0],_2:p[0]},c),l.click($.proxy(this.compile,this)),n.click($.proxy(this.compile,this)),p.click($.proxy(this.compile,this))}},SVGSpriteConfigurator.prototype.buildManual=function(a,b,c,d){var e=d.join("_")+(d.length?"_":"")+b,f=$('<span class="manual"><input type="checkbox" name="'+e+'" value="1" data-skip="'+c.skip+'"'+(c["default"]?' checked="checked"':"")+"/> Enable and edit manually</span>");a.append($("<label"+(c.emphasize?' class="emphasize"':"")+"/>").text(c.label).append($('<span class="id"/>').text(e.split("_").join("."))).prepend(f)),this.register[e]=$.extend({_:f[0]},c),f.click($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.compile=function(){for(var a={},b=this.$form.serializeArray(),c=0;c<b.length;++c)this.traverse(b[c].name.split("_"),b[c].value,a,this.config);for(var d in a)this.refine(d,a,this.config);this.compiled=a,this.update()},SVGSpriteConfigurator.prototype.update=function(){console.log(this.tab.template);var a=JSON.stringify(this.compiled,null,4),b=this.tab.template.split("$$config$$").join(a),c=Prism.highlight(b,Prism.languages.javascript);this.$compiled.html(c)},SVGSpriteConfigurator.prototype.traverse=function(a,b,c,d,e){var f=a.shift();if(!(f in d))throw new"Invalid property: ".property;if(a.length)f in c||(c[f]={}),this.traverse(a,b,c[f],d[f],(e||"")+f+"_");else{switch(d[f].type){case"string":b=$.trim(b);break;case"integer":b=Math.max(0,parseInt(b||0,10));break;case"boolean":b=!!parseInt(b||0,10);break;case"select":break;case"enableconfig":b=Math.max(0,Math.min(2,parseInt(b||0,10)));break;case"manual":b=parseInt(b||0,10)?{}:null}f in c?c[f]._=b:c[f]={_:b}}},SVGSpriteConfigurator.prototype.refine=function(a,b,c){var d=c[a],e=d["default"],f=parseInt(d.skip||0,10),g=b[a]._,h=0;switch(d.process||d.type){case"integer":if(!g&&1&f){delete b[a];break}case"string":case"select":!(""+g).length&&1&f||g===e&&2&f?delete b[a]:(b[a]=g,++h);break;case"section":var i=0;for(var j in b[a])i+=this.refine(j,b[a],d);i?h+=i:delete b[a];break;case"boolean":g===e&&2&f?delete b[a]:(b[a]=g,++h);break;case"enableconfig":if(e===g&&2&f)delete b[a];else if(2>g)b[a]=!!g,++h;else{var i=0;for(var j in b[a])"_"!=j&&(i+=this.refine(j,b[a],d));i?(delete b[a]._,h+=i):(b[a]=!0,++h)}break;case"manual":g?(b[a]=g,++h):delete b[a];break;case"transform":var i=0;for(var j in b[a])i+=this.refine(j,b[a],d);if(i){h+=i,g=[];for(var k in b[a]){var l=b[a][k];if(l===!0)g=null;else if("object"==typeof l){var m=[];for(var n in l){var o={};o[n]=l[n],m.push(o)}if(m.length){var p={};p[k]={plugins:m},g.push(p)}}}null===g?delete b[a]:b[a]=g}else delete b[a]}return h},window.location.hash="json",new SVGSpriteConfigurator({dest:{type:"string",label:"Main output directory","default":".",skip:3},log:{type:"select",label:"Log verbosity","default":null,skip:3,options:{"":"No logging",info:"Informal",verbose:"Verbose",debug:"Debug information"}},shape:{type:"section",label:"SVG shape properties",skip:3,id:{type:"section",label:"Shape ID properties",skip:3,separator:{type:"string",label:"Directory separator replacement","default":"--",skip:3},generator:{type:"string",label:"Generator template or callback","default":null,skip:3},pseudo:{type:"string",label:"Pseudo-class delimiter","default":"~",skip:3}},dimension:{type:"section",label:"Dimensions",skip:3,maxWidth:{type:"integer",label:"Max. shape width","default":2e3,skip:3},maxHeight:{type:"integer",label:"Max. shape height","default":2e3,skip:3},precision:{type:"integer",label:"Decimal precision","default":2,skip:3},attributes:{type:"boolean",label:"Add dimension attributes","default":!1,skip:3}},spacing:{type:"section",label:"Spacing",skip:3,padding:{type:"integer",label:"Padding on all edges","default":0,skip:3},box:{type:"select",label:"Box sizing strategy","default":"content",skip:3,options:{content:"Content box",padding:"Padding box"}}},meta:{type:"string",label:"Meta data YAML file",skip:3,"default":null},align:{type:"string",label:"Alignment data YAML file",skip:3,"default":null},dest:{type:"string",label:"SVG shape output directory",skip:3,"default":null}},transform:{type:"section",label:"SVG shape transformations",skip:3,process:"transform",svgo:{type:"enableconfig",label:"SVGO",skip:3,"default":1,cleanupAttrs:{type:"boolean",label:"Cleanup attributes from whitespace","default":!0,skip:3},removeDoctype:{type:"boolean",label:"Remove DOCTYPE declaration","default":!0,skip:3},removeXMLProcInst:{type:"boolean",label:"Remove XML declaration","default":!0,skip:3},removeComments:{type:"boolean",label:"Remove comments","default":!0,skip:3},removeMetadata:{type:"boolean",label:"Remove <metadata>","default":!0,skip:3},removeTitle:{type:"boolean",label:"Remove <title>","default":!0,skip:3},removeEditorsNSData:{type:"boolean",label:"Remove editor markup","default":!0,skip:3},removeEmptyAttrs:{type:"boolean",label:"Remove empty attributes","default":!0,skip:3},removeHiddenElems:{type:"boolean",label:"Remove hidden elements","default":!0,skip:3},removeEmptyText:{type:"boolean",label:"Remove empty texts","default":!0,skip:3},removeEmptyContainers:{type:"boolean",label:"Remove empty containers","default":!0,skip:3},removeViewBox:{type:"boolean",label:"Remove viewBox","default":!1,skip:3},cleanupEnableBackground:{type:"boolean",label:'Cleanup "enable-background" attribute',"default":!0,skip:3},convertStyleToAttrs:{type:"boolean",label:"Convert styles to attributes","default":!0,skip:3},convertColors:{type:"boolean",label:"Convert colors to attributes","default":!0,skip:3},convertPathData:{type:"boolean",label:"Convert path data","default":!0,skip:3},convertTransform:{type:"boolean",label:"Collapse multiple transforms","default":!0,skip:3},removeUnknownsAndDefaults:{type:"boolean",label:"Remove unknown elements and attributes","default":!0,skip:3},removeNonInheritableGroupAttrs:{type:"boolean",label:"Remove non-inheritable presentation attributes","default":!0,skip:3},removeUnusedNS:{type:"boolean",label:"Remove unused namespace declarations","default":!0,skip:3},cleanupIDs:{type:"boolean",label:"Remove unused and minify used IDs","default":!0,skip:3},cleanupNumericValues:{type:"boolean",label:"Round numeric values to fixed precision","default":!0,skip:3},moveElemsAttrsToGroup:{type:"boolean",label:"Move element attributes to group wrappers","default":!0,skip:3},moveGroupAttrsToElems:{type:"boolean",label:"Move some group attributes to content elements","default":!1,skip:3},collapseGroups:{type:"boolean",label:"Collapse useless groups","default":!0,skip:3},removeRasterImages:{type:"boolean",label:"Remove raster images","default":!1,skip:3},mergePaths:{type:"boolean",label:"Merge multiple paths into one","default":!0,skip:3},convertShapeToPath:{type:"boolean",label:"Convert some basic shapes to paths","default":!0,skip:3},transformsWithOnePath:{type:"boolean",label:"Apply transforms, crop by real width","default":!0,skip:3}}},svg:{type:"section",label:"SVG sprite properties",skip:3,xmlDeclaration:{type:"boolean",label:"Add XML declaration","default":!0,skip:3},doctypeDeclaration:{type:"boolean",label:"Add DOCTYPE declaration","default":!0,skip:3},namespaceIDs:{type:"boolean",label:"Apply ID namespacing","default":!0,skip:3},dimensionAttributes:{type:"boolean",label:"Add dimension attributes","default":!0,skip:3}},mode:{type:"section",label:"Output modes",emphasize:!0,skip:3,css:{type:"enableconfig",label:"«css» sprite","default":0,skip:3,dest:{type:"string",label:"Output directory","default":"css",skip:3},layout:{type:"select",label:"Sprite layout","default":"packed",skip:3,options:{vertical:"Vertical",horizontal:"Horizontal",diagonal:"Diagonal",packed:"Packed"}},common:{type:"string",label:"Common CSS class name","default":null,skip:3},prefix:{type:"string",label:"CSS selector prefix","default":"svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix","default":"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name","default":"svg/sprite.css.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting","default":!0,skip:3},render:{type:"section",label:"Rendering configurations",emphasize:!0,skip:3,css:{type:"enableconfig",label:"Render CSS stylesheet","default":0,skip:3,template:{type:"string",label:"CSS stylesheet template","default":"tmpl/css/sprite.css",skip:3},dest:{type:"string",label:"CSS stylesheet destination","default":"sprite.css",skip:3}},scss:{type:"enableconfig",label:"Render Sass stylesheet","default":0,skip:3,template:{type:"string",label:"Sass stylesheet template","default":"tmpl/css/sprite.scss",skip:3},dest:{type:"string",label:"Sass stylesheet destination","default":"sprite.scss",skip:3}},less:{type:"enableconfig",label:"Render LESS stylesheet","default":0,skip:3,template:{type:"string",label:"LESS stylesheet template","default":"tmpl/css/sprite.scss",skip:3},dest:{type:"string",label:"SCSS stylesheet destination","default":"sprite.scss",skip:3}},styl:{type:"enableconfig",label:"Render Stylus stylesheet","default":0,skip:3,template:{type:"string",label:"Stylus stylesheet template","default":"tmpl/css/sprite.styl",skip:3},dest:{type:"string",label:"Stylus stylesheet destination","default":"sprite.styl",skip:3}}},example:{type:"enableconfig",label:"Render HTML example","default":0,skip:3,template:{type:"string",label:"HTML document template","default":"tmpl/css/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination","default":"sprite.css.html",skip:3}}},view:{type:"enableconfig",label:"«view» sprite","default":0,skip:3,dest:{type:"string",label:"Output directory","default":"view",skip:3},layout:{type:"select",label:"Sprite layout","default":"packed",skip:3,options:{vertical:"Vertical",horizontal:"Horizontal",diagonal:"Diagonal",packed:"Packed"}},common:{type:"string",label:"Common CSS class name","default":null,skip:3},prefix:{type:"string",label:"CSS selector prefix","default":"svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix","default":"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name","default":"svg/sprite.view.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting","default":!0,skip:3},render:{type:"section",label:"Rendering configurations",emphasize:!0,skip:3,css:{type:"enableconfig",label:"Render CSS stylesheet","default":0,skip:3,template:{type:"string",label:"CSS stylesheet template","default":"tmpl/view/sprite.css",skip:3},dest:{type:"string",label:"CSS stylesheet destination","default":"sprite.css",skip:3}},scss:{type:"enableconfig",label:"Render Sass stylesheet","default":0,skip:3,template:{type:"string",label:"Sass stylesheet template","default":"tmpl/view/sprite.scss",skip:3},dest:{type:"string",label:"Sass stylesheet destination","default":"sprite.scss",skip:3}},less:{type:"enableconfig",label:"Render LESS stylesheet","default":0,skip:3,template:{type:"string",label:"LESS stylesheet template","default":"tmpl/view/sprite.scss",skip:3},dest:{type:"string",label:"SCSS stylesheet destination","default":"sprite.scss",skip:3}},styl:{type:"enableconfig",label:"Render Stylus stylesheet","default":0,skip:3,template:{type:"string",label:"Stylus stylesheet template","default":"tmpl/view/sprite.styl",skip:3},dest:{type:"string",label:"Stylus stylesheet destination","default":"sprite.styl",skip:3}}},example:{type:"enableconfig",label:"Render HTML example","default":0,skip:3,template:{type:"string",label:"HTML document template","default":"tmpl/view/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination","default":"sprite.view.html",skip:3}}},defs:{type:"enableconfig",label:"«defs» sprite","default":0,skip:3,dest:{type:"string",label:"Output directory","default":"defs",skip:3},prefix:{type:"string",label:"CSS selector prefix","default":"svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix","default":"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name","default":"svg/sprite.defs.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting","default":!1,skip:3},inline:{type:"boolean",label:"Prepare for inline embedding","default":!1,skip:3},example:{type:"enableconfig",label:"Render HTML example","default":0,skip:3,template:{type:"string",label:"HTML document template","default":"tmpl/defs/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination","default":"sprite.defs.html",skip:3}}},symbol:{type:"enableconfig",label:"«symbol» sprite","default":0,skip:3,dest:{type:"string",label:"Output directory","default":"symbol",skip:3},prefix:{type:"string",label:"CSS selector prefix","default":"svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix","default":"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name","default":"svg/sprite.symbol.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting","default":!1,skip:3},inline:{type:"boolean",label:"Prepare for inline embedding","default":!1,skip:3},example:{type:"enableconfig",label:"Render HTML example","default":0,skip:3,template:{type:"string",label:"HTML document template","default":"tmpl/symbol/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination","default":"sprite.symbol.html",skip:3}}},stack:{type:"enableconfig",label:"«stack» sprite","default":0,skip:3,dest:{type:"string",label:"Output directory","default":"stack",skip:3},prefix:{type:"string",label:"CSS selector prefix","default":"svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix","default":"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name","default":"svg/sprite.stack.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting","default":!1,skip:3},example:{type:"enableconfig",label:"Render HTML example","default":0,skip:3,template:{type:"string",label:"HTML document template","default":"tmpl/stack/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination","default":"sprite.stack.html",skip:3}}}},variables:{type:"manual",label:"Custom Mustache templating variables",skip:3}},$("#configurator"),$("#compiled"),$(".tabs a"),!0),window.setTimeout(function(){window.scrollTo(0,0)},0);